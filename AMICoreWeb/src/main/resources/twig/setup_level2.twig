<!DOCTYPE html>

<html lang="en">
	<head>
		<meta charset="utf-8"/>

		<title>AMI wizard</title>

		<link rel="stylesheet" href="css/bootstrap.min.css" />
		<link rel="stylesheet" href="css/bootstrap-icons.min.css" />
		<link rel="stylesheet" href="css/tagin.min.css" />

		<script type="text/javascript" src="js/jquery.min.js"></script>
		<script type="text/javascript" src="js/tagin.min.js"></script>
		<script type="text/javascript" src="js/wizard.js"></script>

		<style>
			.modal-header {
				border-top-left-radius: 6px;
				border-top-right-radius: 6px;
				background: rgb(255, 255, 255) url("images/stripe1.png");
			}

			.modal-footer {
				border-bottom-left-radius: 6px;
				border-bottom-right-radius: 6px;
				background: rgb(245, 245, 245) url("images/stripe2.png");
			}
		</style>
	</head>
	<body style="background: white url('images/background.jpg') fixed; background-size: cover;">

		<div class="modal-dialog modal-lg shadow-lg mb-2">
			<form method="post" action="" class="modal-content" onsubmit="return validateForm();">

				<div class="modal-header py-2">
					<img src="images/logo.png" alt="AMI" style="height: 38px;" />

					<span class="fs-3"><i class="bi bi-magic"></i> wizard <kbd>2/3</kbd></span>
				</div>

				<div class="modal-body">

					<div id="message"></div>

					<div class="row">

						<div class="col-md-2 text-center text-primary">
							<i class="bi bi-hdd-network" style="font-size: 48pt;"></i>
						</div>

						<div class="col-md-10">

							<h5 class="text-right"><span class="badge bg-dark">Server</span></h5>

							<div class="mb-2">
								<label class="control-label" for="base_url">Base URL<sup class="text-danger">*</sup></label>
								<input class="form-control" type="text" name="base_url" value="{{BASE_URL}}" id="base_url" required="required" />
							</div>

							<div class="row">
								<div class="col-md-6">
									<div class="mb-2">
										<label class="control-label" for="admin_user">Admin Username<sup class="text-danger">*</sup></label>
										<input class="form-control" type="text" name="admin_user" value="{{ADMIN_USER}}" id="admin_user" required="required" />
									</div>
								</div>
								<div class="col-md-6">
									<div class="mb-2">
										<label class="control-label" for="admin_pass">Admin Password<sup class="text-danger">*</sup></label>
										<input class="form-control" type="text" name="admin_pass" value="{{ADMIN_PASS}}" id="admin_pass" required="required" />
									</div>
								</div>
							</div>

							<div class="mb-2">
								<label class="control-label" for="admin_email">Admin E-Mail<sup class="text-danger">*</sup></label>
								<input type="email" class="form-control" name="admin_email" value="{{ADMIN_EMAIL}}" id="admin_email" required="required" />
							</div>

							<div class="mb-2">
								<label class="control-label" for="encryption_key">Encryption Key<sup class="text-danger">*</sup></label>
								<div class="input-group">
									<input class="form-control" type="text" name="encryption_key" value="{{ENCRYPTION_KEY}}" id="encryption_key" required="required" />
									<button type="button" class="btn btn-outline-secondary" onclick="generateEncryptionKey();">Generate</button>
								</div>
							</div>

							<div class="mb-2">
								<label class="control-label" for="authorized_ips">Authorized IPs<sup class="text-danger">*</sup></label>
								<input type="text" class="form-control tagin" name="authorized_ips" value="{{AUTHORIZED_IPS}}" id="authorized_ips" xxxxxxxx="xxxxxxxx" />
							</div>

						</div>

					</div>

					<div class="row">

						<div class="col-md-2 text-center text-primary">
							<i class="bi bi-hdd-network" style="font-size: 48pt;"></i>
						</div>

						<div class="col-md-10">

							<h5 class="text-right"><span class="badge bg-dark">AMI Database</span></h5>

							<div class="row">
								<div class="col-md-6">
									<div class="mb-2">
										<label class="control-label" for="router_catalog">Catalog<sup class="text-danger">*</sup></label>
										<input class="form-control" type="text" name="router_catalog" value="{{ROUTER_CATALOG}}" id="router_catalog" required="required" />
									</div>
								</div>
								<div class="col-md-6">
									<div class="mb-2">
										<label class="control-label" for="route_schema">Schema<sup class="text-info">opt</sup></label>
										<input class="form-control" type="text" name="router_schema" value="{{ROUTER_SCHEMA}}" id="route_schema" xxxxxxxx="xxxxxxxx" />
									</div>
								</div>
							</div>

							<div class="mb-2">
								<label class="control-label" for="router_url">URL<sup class="text-danger">*</sup></label>
								<textarea class="form-control" rows="3" name="router_url" id="router_url" required="required">{{ROUTER_URL}}</textarea>
							</div>

							<div class="row">
								<div class="col-md-6">
									<div class="mb-2">
										<label class="control-label" for="router_user">Username<sup class="text-danger">*</sup></label>
										<input class="form-control" type="text" name="router_user" value="{{ROUTER_USER}}" id="router_user" required="required" />
									</div>
								</div>
								<div class="col-md-6">
									<div class="mb-2">
										<label class="control-label" for="router_pass">Password<sup class="text-danger">*</sup></label>
										<input class="form-control" type="text" name="router_pass" value="{{ROUTER_PASS}}" id="router_pass" required="required" />
									</div>
								</div>
							</div>

							<div class="row">
								<div class="col-md-6">
									<div class="form-check">
										<input class="form-check-input" type="checkbox" name="router_reset" id="router_reset">
										<label class="form-check-label text-danger" for="router_reset">Reset the AMI database</label>
									</div>
								</div>
								<div class="col-md-6">
									<div class="mb-2">
										<label class="control-label" for="time_zone">Time Zone<sup class="text-danger">*</sup></label>
										<select class="form-select" name="time_zone" value="{{TIME_ZONE}}" id="time_zone">
											<option value="UTC">UTC</option>
										</select>
									</div>
								</div>
							</div>

							<input type="hidden" name="Level" value="3" />

						</div>

					</div>


					<div class="row">

						<div class="col-md-2 text-center text-primary">
							<i class="bi bi-plug" style="font-size: 48pt;"></i>
						</div>

						<div class="col-md-10">

							<h5 class="text-right"><span class="badge bg-dark">Custom Extensions</span></h5>

							<div class="mb-2">
								<label for="class_path" class="control-label">Class Path<sup class="text-info">opt</sup></label>
								<input class="form-control" type="text" name="class_path" value="{{CLASS_PATH}}" id="class_path" xxxxxxxx="xxxxxxxx" />
							</div>

						</div>

					</div>

				</div>

				<div class="modal-footer py-1">
					<button class="btn btn-outline-primary" type="submit" id="next"><i class="bi bi-chevron-double-right"></i></button>
				</div>

			</form>
		</div>

		<div class="text-center mb-4">
			<span class="badge rounded-pill bg-dark">
				Copyright Â© 2001-{{YEAR}}, <a class="text-white" href="https://lpsc.in2p3.fr/" target="_blank">CNRS/LPSC</a>. All right reserved.
			</span>
		</div>

		<script>

			new Tagin(document.querySelector('#authorized_ips'), {
				separator: ',',
				duplicate: false,
				placeholder: 'IP (then press coma)'
			});

		</script>

	</body>
</html>
