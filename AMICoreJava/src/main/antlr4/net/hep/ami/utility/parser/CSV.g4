/*-------------------------------------------------------------------------*/

grammar CSV;

/*-------------------------------------------------------------------------*/

options {
	language = Java;
}

/*-------------------------------------------------------------------------*/
/* CSV PARSER                                                              */
/*-------------------------------------------------------------------------*/

file
	: (comment | row)*
	;

/*-------------------------------------------------------------------------*/

comment
	: COMMENT BREAK?
	;

/*-------------------------------------------------------------------------*/

row
	: field (',' field)* BREAK?
	;

/*-------------------------------------------------------------------------*/

field
	: STRING
	| VALUE
	;

/*-------------------------------------------------------------------------*/
/* CSV LEXER                                                               */
/*-------------------------------------------------------------------------*/

COMMENT
	: '#' ~[\n\r]*
	;

/*-------------------------------------------------------------------------*/

STRING
	: '"' ('""' | '\\"' | ~'"')* '"'
	| '\'' ('\'\'' | '\\\'' | ~'\'')* '\''
	;

/*-------------------------------------------------------------------------*/

VALUE
	: ~[,"\'\n\r]+
	;

/*-------------------------------------------------------------------------*/

BREAK
	: '\r' '\n'
	| '\r'
	| '\n'
	;

/*-------------------------------------------------------------------------*/
